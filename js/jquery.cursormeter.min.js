(function(f){var h={x:-1,y:-1},n={x:null,y:null},q=null,a,p=0,o=0,c=0,b=0,l,i,d;function g(t){if(t<100){return j(t,"cm")+" cm"}else{if(t<10000){return j(t,"m")+" m"}else{return j(t,"km")+" km"}}}function j(u,w){var t;switch(w){case"cm":t=Math.round(u*100)/100;break;case"m":distanceInMetres=u/100;t=Math.round(distanceInMetres*100)/100;break;case"km":var v=u/10000;t=Math.round(v*100)/100}return t.toFixed(2)}function k(){return{x:p/a,y:o/a,ratio:a,total:c}}function s(){}function e(){f(document).one("mousemove",function(t){h.x=t.pageX;h.y=t.pageY});if(h.x==-1){return}if(n.x==null&&n.y==null){n.x=h.x;n.y=h.y;return}else{if(n.x==h.x&&n.y==h.y){return}}if(h.x!=n.x){p+=Math.abs(h.x-n.x);n.x=h.x}if(h.y!=n.y){o+=Math.abs(h.y-n.y);n.y=h.y}c=(o+p)/a;if(d.autoUnitsConverter){l.text(g(c))}else{if(jQuery.isFunction(d.converter)){l.text(d.converter(j(c,d.unitsBase)))}else{l.text(j(c,d.unitsBase))}}if(i){tmpDst=b+c;if(d.autoUnitsConverter){i.text(g(tmpDst))}else{if(jQuery.isFunction(d.converter)){i.text(d.converter(j(tmpDst,d.unitsBase)))}else{i.text(j(tmpDst,d.unitsBase))}}}if(jQuery.isFunction(d.onUpdate)){d.onUpdate()}}function m(){var t=f("<div>").css({width:"1cm",padding:"0",margin:"0"}).appendTo("body"),u=d.refreshRate*100;l=f(d.currDistSelector).text("0");a=t.width();t.remove();f(document).on("mouseleave",function(v){h={x:-1,y:-1};n={x:null,y:null};clearInterval(q)}).on("mouseenter",function(v){q=setInterval(function(){e()},u)});if(d.updateUrl!=null){i=f(d.totalDistSelector).text("0");f.ajax({url:d.updateUrl,type:"POST",data:{action:"get"},dataType:"json"}).done(function(v){b=v.globalDistance;if(d.autoUnitsConverter){i.text(g(b))}else{if(jQuery.isFunction(d.converter)){i.text(d.converter(j(b,d.unitsBase)))}else{i.text(j(b,d.unitsBase))}}});f(window).on("beforeunload",function(){var v=f.extend({},k(),{action:"put"});f.ajax({url:d.updateUrl,type:"POST",data:v,dataType:"json",async:false})})}q=setInterval(function(){e()},u)}function r(){f(document).unbind("mousemove mouseleave mouseenter");f(window).unbind("beforeunload");window.clearInterval(q);return k()}f.cursorMeter=function(u){var t={currDistSelector:"#current-distance",totalDistSelector:"#total-distance",refreshRate:1,updateUrl:null,autoUnitsConverter:true,onUpdate:null,converter:null,unitsBase:"cm"};d=f.extend({},t,u);m();return{destroy:function(){return r()},data:function(){return k()}}}})(jQuery);